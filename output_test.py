# import xlwt
import pandas as pd
# 创建一个工作簿
# workbook = xlwt.Workbook()
#
# # 添加一个工作表
# sheet = workbook.add_sheet('Sheet1')

#
# # 保存工作簿
# workbook.save('example_xlwt.xls')


cnn_acc_list = [
{'dataset ID 0:':{'grouped':{'total': 43.37,'00-00': 34.0,'01-01': 24.8, '02-02': 73.8, '03-03': 56.9,'04-04': 54.7,'05-05': 16.0,'old': 0,'new': 43.37},'top1': 43.37,'top2': 66.0}},


 {'dataset ID 0:':{'grouped': {'total': 43.66,'00-00': 7.8, '01-01': 25.9,'02-02': 35.5, '03-03': 75.9, '04-04': 86.3, '05-05': 9.5, '06-06': 64.7, 'old': 7.8,'new': 49.63},'top1': 43.66,'top2': 62.07},
  'dataset ID 1:': {'grouped': {'total': 43.66, '00-00': 7.8,'01-01': 25.9, '02-02': 35.5,'03-03': 75.9,'04-04': 86.3, '05-05': 9.5,'06-06': 64.7, 'old': 7.8,'new': 49.63},'top1': 43.66,'top2': 62.07}},


 {'dataset ID 0:': {'grouped': {'total': 49.09,
    '00-00': 4.0,
    '01-01': 17.9,
    '02-02': 58.5,
    '03-03': 80.4,
    '04-04': 82.7,
    '05-05': 42.2,
    '06-06': 43.7,
    '07-07': 63.3,
    'old': 10.95,
    'new': 61.8},
   'top1': 49.09,
   'top2': 69.22},
  'dataset ID 1:': {'grouped': {'total': 49.09,
    '00-00': 4.0,
    '01-01': 17.9,
    '02-02': 58.5,
    '03-03': 80.4,
    '04-04': 82.7,
    '05-05': 42.2,
    '06-06': 43.7,
    '07-07': 63.3,
    'old': 10.95,
    'new': 61.8},
   'top1': 49.09,
   'top2': 69.22},
  'dataset ID 2:': {'grouped': {'total': 49.09,
    '00-00': 4.0,
    '01-01': 17.9,
    '02-02': 58.5,
    '03-03': 80.4,
    '04-04': 82.7,
    '05-05': 42.2,
    '06-06': 43.7,
    '07-07': 63.3,
    'old': 10.95,
    'new': 61.8},
   'top1': 49.09,
   'top2': 69.22}},



 {'dataset ID 0:': {'grouped': {'total': 48.67,
    '00-00': 0.0,
    '01-01': 4.1,
    '02-02': 2.7,
    '03-03': 83.4,
    '04-04': 80.2,
    '05-05': 69.3,
    '06-06': 63.4,
    '07-07': 48.2,
    '08-08': 86.7,
    'old': 2.27,
    'new': 71.87},
   'top1': 48.67,
   'top2': 67.54},
  'dataset ID 1:': {'grouped': {'total': 48.67,
    '00-00': 0.0,
    '01-01': 4.1,
    '02-02': 2.7,
    '03-03': 83.4,
    '04-04': 80.2,
    '05-05': 69.3,
    '06-06': 63.4,
    '07-07': 48.2,
    '08-08': 86.7,
    'old': 2.27,
    'new': 71.87},
   'top1': 48.67,
   'top2': 67.54},
  'dataset ID 2:': {'grouped': {'total': 48.67,
    '00-00': 0.0,
    '01-01': 4.1,
    '02-02': 2.7,
    '03-03': 83.4,
    '04-04': 80.2,
    '05-05': 69.3,
    '06-06': 63.4,
    '07-07': 48.2,
    '08-08': 86.7,
    'old': 2.27,
    'new': 71.87},
   'top1': 48.67,
   'top2': 67.54},
  'dataset ID 3:': {'grouped': {'total': 48.67,
    '00-00': 0.0,
    '01-01': 4.1,
    '02-02': 2.7,
    '03-03': 83.4,
    '04-04': 80.2,
    '05-05': 69.3,
    '06-06': 63.4,
    '07-07': 48.2,
    '08-08': 86.7,
    'old': 2.27,
    'new': 71.87},
   'top1': 48.67,
   'top2': 67.54}},


 {'dataset ID 0:': {'grouped': {'total': 50.05,
    '00-00': 0.0,
    '01-01': 0.7,
    '02-02': 0.9,
    '03-03': 56.0,
    '04-04': 77.2,
    '05-05': 63.5,
    '06-06': 88.3,
    '07-07': 67.6,
    '08-08': 64.1,
    '09-09': 82.2,
    'old': 14.4,
    'new': 73.82},
   'top1': 50.05,
   'top2': 65.39},
  'dataset ID 1:': {'grouped': {'total': 50.05,
    '00-00': 0.0,
    '01-01': 0.7,
    '02-02': 0.9,
    '03-03': 56.0,
    '04-04': 77.2,
    '05-05': 63.5,
    '06-06': 88.3,
    '07-07': 67.6,
    '08-08': 64.1,
    '09-09': 82.2,
    'old': 14.4,
    'new': 73.82},
   'top1': 50.05,
   'top2': 65.39},
  'dataset ID 2:': {'grouped': {'total': 50.05,
    '00-00': 0.0,
    '01-01': 0.7,
    '02-02': 0.9,
    '03-03': 56.0,
    '04-04': 77.2,
    '05-05': 63.5,
    '06-06': 88.3,
    '07-07': 67.6,
    '08-08': 64.1,
    '09-09': 82.2,
    'old': 14.4,
    'new': 73.82},
   'top1': 50.05,
   'top2': 65.39},
  'dataset ID 3:': {'grouped': {'total': 50.05,
    '00-00': 0.0,
    '01-01': 0.7,
    '02-02': 0.9,
    '03-03': 56.0,
    '04-04': 77.2,
    '05-05': 63.5,
    '06-06': 88.3,
    '07-07': 67.6,
    '08-08': 64.1,
    '09-09': 82.2,
    'old': 14.4,
    'new': 73.82},
   'top1': 50.05,
   'top2': 65.39},
  'dataset ID 4:': {'grouped': {'total': 50.05,
    '00-00': 0.0,
    '01-01': 0.7,
    '02-02': 0.9,
    '03-03': 56.0,
    '04-04': 77.2,
    '05-05': 63.5,
    '06-06': 88.3,
    '07-07': 67.6,
    '08-08': 64.1,
    '09-09': 82.2,
    'old': 14.4,
    'new': 73.82},
   'top1': 50.05,
   'top2': 65.39}}]
data=[]

for taskDict in cnn_acc_list:
    task_result = []
    # cnn_acc_dict 为一个task对应的数据
    for datasetID,datasetResult in taskDict.items():
        #  v 为dataset ID 0对应的字典
        acc_list = []
        for acc in  datasetResult['grouped'].items():
            k,v = acc
            if k == 'new' or k== 'old':
                continue

            acc_list.append(acc)

        print(len(acc_list))
        for i in range(20):
            if (len(acc_list) <= 10):
                acc_list.append([])
            else:
                break
        task_result.extend(acc_list)

    data.append(task_result)
        # for kk, vv in v['grouped'].items():
            #            vv 为{'total': 43.37, '00-00': 34.0, '01-01': 24.8, '02-02': 73.8, '03-03': 56.9, '04-04': 54.7, '05-05': 16.0, 'old': 0, 'new': 43.37}, 'top1': 43.37, 'top2': 66.0}
            # for kkk, vvv in vv.items():
                # vvv 为对应的数字

            # print(kk, ":", vv,end="        ")
            # datasetResult.append(vv)
            # # 写入数据
            # sheet.write(0, 0, '姓名')
            # sheet.write(0, 1, '年龄')
            # sheet.write(1, 0, 'Bob')
            # sheet.write(1, 1, 30)

        # print("\n" ,k)
df = pd.DataFrame(data)
writer = pd.ExcelWriter('output.xlsx', engine='xlsxwriter')
df.to_excel(writer, index=False, sheet_name='Sheet1')
writer.close()